<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: main.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: main.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @file main.js
 * @author Jacopo Dell'Oste
 * 
 * @description
 * This script loads multiple car objects from remote JSON endpoints in parallel using XMLHttpRequest.
 * While loading, it shows a loader message, and once all data is retrieved, it renders
 * the results. Parsing and network errors are logged to the console.
 */

/**
 * The main HTML body element where content will be appended.
 * @type {HTMLBodyElement}
 */
const body = document.body;

/**
 * Array of JSONBlob API endpoints, each containing one car object.
 * @type {string[]}
 */
const carEndpoints = [
    'https://jsonblob.com/api/jsonBlob/1371034507947466752',
    'https://jsonblob.com/api/jsonBlob/1371034901985550336',
    'https://jsonblob.com/api/jsonBlob/1371035331100598272',
    'https://jsonblob.com/api/jsonBlob/1371035595291418624',
    'https://jsonblob.com/api/jsonBlob/1371035850028277760',
];

/**
 * Loader element displayed while car data is loading.
 * @type {HTMLHeadingElement}
 */
const loader = document.createElement("h2");
loader.textContent = "Loading Cars Details...";
body.append(loader);

/**
 * Creates an &lt;li> element with provided text content.
 * 
 * @param {string} text - The text to display inside the list item.
 * @returns {HTMLLIElement} - The created list item.
 */
function createLi(text) {
    const li = document.createElement("li");
    li.textContent = text;
    return li;
}

/**
 * Builds a list item element representing a single car and its nested details.
 * 
 * @param {Object} car - The car object from JSON response.
 * @returns {HTMLLIElement} - A list item containing all structured car info.
 */
function createCarElement(car) {
    const carLi = document.createElement("li");
    
    carLi.classList.add("carItem");

    const carDetails = document.createElement("ul");

    carDetails.classList.add("carList");

    // Basic info
    carDetails.append(
        createLi(`ID: ${car.id}`),
        createLi(`Brand: ${car.brand}`),
        createLi(`Model: ${car.model}`),
        createLi(`Year of Registration: ${car.yearOfRegistration}`),
        createLi(`Automatic: ${car.automatic ? "Yes" : "No"}`)
    );

    // Optionals
    const optionalWrapper = createLi("Optional:");

    const optionalList = document.createElement("ul");

    optionalList.classList.add("carList");

    if (Array.isArray(car.optional)) 
        optionalList.append(...car.optional.map(opt => createLi(opt)));
    else
        optionalList.append(createLi("No optionals available"));

    optionalWrapper.append(optionalList);

    carDetails.append(optionalWrapper);

    // Engine info
    const engineWrapper = createLi("Engine:");

    const engineList = document.createElement("ul");

    engineList.classList.add("carList");

    engineList.append(
        createLi(`Type: ${car.engine.type}`),
        createLi(`Horse Power: ${car.engine.horsePower}`),
        createLi(`Emission Standard: ${car.engine.emmissionStandard}`)
    );

    engineWrapper.append(engineList);

    carDetails.append(engineWrapper);

    // Owner
    carDetails.append(createLi(`Owner: ${car.owner ? car.owner : "None"}`));

    carLi.append(carDetails);

    return carLi;
}

/**
 * Stores all successfully loaded car elements.
 * @type {HTMLLIElement[]}
 */
let loadedCars = [];

/**
 * Counter to track how many requests have completed (success or failure).
 * @type {number}
 */
let completedRequests = 0;

/**
 * Container list for displaying all cars.
 * @type {HTMLUListElement}
 */
const ul = document.createElement("ul");

ul.classList.add("carList");

/**
 * Sends one parallel XMLHttpRequest for each car URL.
 * When all are completed, removes the loader and appends the results.
 */
carEndpoints.forEach((url) => {
    const request = new XMLHttpRequest();

    request.open("GET", url, true);

    request.onreadystatechange = function () {
        if (request.readyState === XMLHttpRequest.DONE) {
            completedRequests++;

            if (request.status === 200) {
                try {
                    const car = JSON.parse(request.responseText);

                    const carEl = createCarElement(car);

                    loadedCars.push(carEl);
                } catch (e) {
                    console.error(`Error parsing JSON from ${url}:`, e);
                }
            } else {
                console.error(`Failed to load from ${url}: status ${request.status}`);
            }

            // Final rendering when all requests are done
            if (completedRequests === carEndpoints.length) {
                loader.remove();

                loadedCars.forEach(carEl => ul.append(carEl));

                body.append(ul);
            }
        }
    };

    request.onerror = function () {
        completedRequests++;
        console.error(`Network error with ${url}`);
    };

    request.send();
});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#body">body</a></li><li><a href="global.html#carEndpoints">carEndpoints</a></li><li><a href="global.html#completedRequests">completedRequests</a></li><li><a href="global.html#createCarElement">createCarElement</a></li><li><a href="global.html#createLi">createLi</a></li><li><a href="global.html#loadedCars">loadedCars</a></li><li><a href="global.html#loader">loader</a></li><li><a href="global.html#ul">ul</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Sun May 11 2025 11:42:16 GMT+0200 (Ora legale dellâ€™Europa centrale)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
