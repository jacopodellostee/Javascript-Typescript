<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: cars.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: cars.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @file cars.js
 * @author Jacopo Dell'Oste
 * 
 * 
 * @description
 * This file fetches a list of cars from a remote API and dynamically displays each car 
 * as a collapsible panel with detailed information and a pre-filled form for potential editing.
 * Each car section includes brand, model, year, optional features, and engine specs.
 */

document.addEventListener("DOMContentLoaded", () => {

    /**
     * Container element where all car panels will be appended.
     * @type {HTMLElement}
     */
    const carsWrapper = document.querySelector(".carsWrapper");

    /**
     * Endpoint from which car data is retrieved.
     * @type {string}
     */
    const carsEndpoint = "https://jsonblob.com/api/jsonBlob/1370457368546172928";

    /**
     * XMLHttpRequest object to request car data.
     * @type {XMLHttpRequest}
     */
    const request = new XMLHttpRequest();

    request.open('GET', carsEndpoint, true);

    request.setRequestHeader('Content-type', 'application/json');

    /**
     * Creates a clickable collapsible header element.
     * @param {string} label - The text displayed on the collapsible header.
     * @returns {HTMLAnchorElement}
     */
    function createCollapsible(label) {
        const a = document.createElement("a");

        a.href = "#";

        a.classList.add("collapsible");

        a.textContent = label;

        return a;
    }

    /**
     * Creates a hidden div to act as the collapsible content container.
     * @returns {HTMLDivElement}
     */
    function createContent() {
        const div = document.createElement("div");

        div.classList.add("content");

        div.style.display = "none";

        return div;
    }

    /**
     * Creates a list item (`&lt;li>`) with specified text.
     * @param {string} text
     * @returns {HTMLLIElement}
     */
    function createLi(text) {
        const li = document.createElement("li");

        li.textContent = text;

        return li;
    }

    /**
     * Creates an empty unordered list.
     * @returns {HTMLUListElement}
     */
    function createUl() {
        return document.createElement("ul");
    }

    /**
     * Creates a label associated with an input.
     * @param {HTMLInputElement} input
     * @param {string} text
     * @returns {HTMLLabelElement}
     */
    function createLabel(input, text) {
        let label = document.createElement("label");

        label.htmlFor = input.id;

        label.textContent = text;

        return label;
    }

    /**
     * Creates an input element with the specified name and type.
     * @param {string} name
     * @param {string} type
     * @returns {HTMLInputElement}
     */
    function createInput(name, type) {
        let input = document.createElement("input");

        input.type = type;

        input.id = name;

        return input;
    }

    /**
     * Creates a form element for editing a car's details.
     * Pre-fills fields with the current car data.
     * @param {Object} car - Car object to populate the form with.
     * @returns {HTMLFormElement}
     */
    function createFormEdit(car) {
        let form = document.createElement("form");

        form.classList.add("formEdit");

        let h3 = document.createElement("h3");

        h3.textContent = "Car Modification Form";

        let brand = createInput("brand", "text");

        let brandLabel = createLabel(brand, "Brand:");

        let model = createInput("model", "text");

        let modelLabel = createLabel(model, "Model:");

        let yearOfRegistration = createInput("yearOfRegistration", "number");

        let yearOfRegistrationLabel = createLabel(yearOfRegistration, "Year of Registration:");

        let automatic = createInput("automatic", "checkbox");

        let automaticLabel = createLabel(automatic, "Automatic:");

        let optional = createInput("optional", "text");

        optional.value = Array.isArray(car.optional) ? car.optional.join(", ") : "";

        let optionalLabel = createLabel(optional, "Optional (comma-separated):");

        let engineType = createInput("engineType", "text");

        engineType.value = car.engine?.type || "";

        let engineTypeLabel = createLabel(engineType, "Engine Type:");

        let horsePower = createInput("horsePower", "number");

        horsePower.value = car.engine?.horsePower || "";

        let horsePowerLabel = createLabel(horsePower, "Horse Power:");

        let emissionStandard = createInput("emmissionStandard", "text");

        emissionStandard.value = car.engine?.emmissionStandard || "";

        let emissionStandardLabel = createLabel(emissionStandard, "Emission Standard:");

        let submit = createInput("submit", "submit");

        form.append(
            h3,
            brandLabel, brand,
            modelLabel, model,
            yearOfRegistrationLabel, yearOfRegistration,
            automaticLabel, automatic,
            optionalLabel, optional,
            engineTypeLabel, engineType,
            horsePowerLabel, horsePower,
            emissionStandardLabel, emissionStandard,
            submit
        );

        return form;
    }

    /**
     * Makes the `cars` array accessible globally for interaction in other scripts.
     * @global
     * @type {Object[]}
     */
    window.cars = [];

    // Load and display car data
    request.onload = function () {
        if (request.status === 200) {

            cars = JSON.parse(request.responseText);

            cars.forEach(car => {
                const collapsible = createCollapsible(`Car ${car.id}`);

                const content = createContent();

                const carInfo = createUl();

                carInfo.append(
                    createLi(`Brand: ${car.brand}`),
                    createLi(`Model: ${car.model}`),
                    createLi(`Year Of Registration: ${car.yearOfRegistration}`),
                    createLi(`Automatic: ${car.automatic ? "Yes" : "No"}`),
                    createLi(`Owner: ${Array.isArray(car.owner) ? car.owner.join(", ") : (car.owner ?? "None")}`)
                );

                // Optionals
                const optionalWrapper = createLi("Optional:");

                const optionalList = createUl();

                if (Array.isArray(car.optional)) {
                    optionalList.append(...car.optional.map(opt => createLi(opt)));
                } else {
                    optionalList.append(createLi("No optionals available"));
                }

                optionalWrapper.append(optionalList);

                // Engine
                const engineWrapper = createLi("Engine:");

                const engineList = createUl();

                engineList.append(
                    createLi(`Type: ${car.engine.type}`),
                    createLi(`Horse Power: ${car.engine.horsePower}`),
                    createLi(`Emission Standard: ${car.engine.emmissionStandard}`)
                );

                engineWrapper.append(engineList);

                carInfo.append(optionalWrapper, engineWrapper);

                content.append(carInfo);

                // Append form
                let formEdit = createFormEdit(car);

                content.append(formEdit);

                // Append collapsible + content to wrapper
                carsWrapper.append(collapsible, content);

                // Toggle collapsible visibility
                collapsible.addEventListener("click", function (event) {
                    // prevent the 'a' Tag to reload the page
                    event.preventDefault();

                    this.classList.toggle("active");

                    const isVisible = content.style.display === "block";

                    content.style.display = isVisible ? "none" : "block";
                });
            });

            setupEditForms();

        } else {
            console.error("Request didn't load successfully. Error code:" + request.statusText);
        }
    };

    // Handle network error
    request.onerror = function () {
        console.error("Network Error");
    };

    // Send the request
    request.send();
});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#cars">cars</a></li><li><a href="global.html#createLi">createLi</a></li><li><a href="global.html#createUl">createUl</a></li><li><a href="global.html#factoryDiv">factoryDiv</a></li><li><a href="global.html#factoryEndpoint">factoryEndpoint</a></li><li><a href="global.html#request">request</a></li><li><a href="global.html#setupEditForms">setupEditForms</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Sun May 11 2025 15:12:34 GMT+0200 (Ora legale dellâ€™Europa centrale)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
